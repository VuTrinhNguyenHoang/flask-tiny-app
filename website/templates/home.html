{% extends 'base.html' %} {% block content %}

<h2 class="text-center mb-4">
  <i class="fa-solid fa-rss"></i> Cáº­p Nháº­t Blog Má»›i Nháº¥t
</h2>

<div class="row justify-content-center" id="post-list">
  <!-- Dá»¯ liá»‡u bÃ i viáº¿t sáº½ Ä‘Æ°á»£c load tá»« API -->
</div>

<div class="pagination">
  <button id="prev-page" class="btn btn-primary" disabled>â¬… TrÆ°á»›c</button>
  <span id="page-info">Trang 1</span>
  <button id="next-page" class="btn btn-primary">Tiáº¿p âž¡</button>
</div>

<script>
  let currentPage = 1;
  const postList = document.getElementById("post-list");
  const pageInfo = document.getElementById("page-info");
  const prevPageBtn = document.getElementById("prev-page");
  const nextPageBtn = document.getElementById("next-page");

  function loadPosts(page) {
    fetch(`/api/posts?page=${page}&all=true`)
      .then((response) => response.json())
      .then((data) => {
        postList.innerHTML = "";
        data.posts.forEach((post) => {
          postList.innerHTML += `
                        <div class="col-lg-4 col-md-6 mb-4">
                            <div class="card shadow-sm">
                                <div class="card-body">
                                    <h5 class="card-title">${post.title}</h5>
                                    <p class="post-owner">ðŸ‘¤ <strong>${post.author}</strong></p>
                                    <p class="post-time">ðŸ“… Posted on: ${post.updated_at}</p>
                                    <p class="card-text"> ${post.content} </p>
                                    <a href="/post/${post.slug}" class="btn btn-primary">Xem chi tiáº¿t</a>
                                </div>
                            </div>
                        </div>
                    `;
        });

        pageInfo.innerText = `Trang ${page}`;
        currentPage = page;

        prevPageBtn.disabled = page <= 1;
        nextPageBtn.disabled = !data.has_next;
      });
  }

  prevPageBtn.addEventListener("click", () => {
    if (currentPage > 1) loadPosts(currentPage - 1);
  });

  nextPageBtn.addEventListener("click", () => {
    loadPosts(currentPage + 1);
  });

  loadPosts(1);
</script>

{% endblock %}
